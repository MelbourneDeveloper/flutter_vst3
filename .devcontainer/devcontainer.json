{
  "name": "VST Development Environment",
  "build": {
    "dockerfile": "Dockerfile",
    "context": "."
  },
  "workspaceFolder": "/workspace",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
  "remoteEnv": {
    "VST3_SDK_DIR": "/workspace/vst3sdk",
    "PATH": "/usr/lib/dart/bin:/opt/flutter/bin:${containerEnv:PATH}"
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "Dart-Code.dart-code",
        "Dart-Code.flutter",
        "ms-vscode.cpptools",
        "ms-vscode.cmake-tools",
        "ms-vscode.makefile-tools"
      ],
      "settings": {
        "dart.flutterSdkPath": "/opt/flutter",
        "dart.sdkPath": "/usr/lib/dart",
        "cmake.configureOnOpen": false
      }
    }
  },
  "postCreateCommand": [
    "bash", "-c", 
    "set -e; echo 'Setting up development environment...'; if [ ! -d vst3sdk ]; then echo 'Downloading VST3 SDK...'; curl -L -o vst3sdk.zip https://www.steinberg.net/vst3sdk; unzip -q vst3sdk.zip; if [ -d VST_SDK/vst3sdk ]; then mv VST_SDK/vst3sdk .; rm -rf VST_SDK; fi; rm -f vst3sdk.zip; echo 'VST3 SDK downloaded and extracted.'; else echo 'VST3 SDK already exists, skipping download.'; fi; echo 'Building native library...'; make native; echo 'Dev container ready! Native library built successfully.'"
  ],
  "remoteUser": "vscode",
  "forwardPorts": [3000, 8080],
  "features": {
    "ghcr.io/devcontainers/features/git:1": {}
  }
}